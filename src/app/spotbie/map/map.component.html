<app-loading-screen *ngIf="loading" text="loadingText"></app-loading-screen>

<div [ngClass]="getMapWrapperClass()">
  
  <div [ngClass]="getMapPromptMobileClass()" *ngIf="showMobilePrompt">

    <div [ngClass]="getMapPromptMobileInnerWrapperClassOne()">

      <div [ngStyle]="getMapPromptMobileInnerWrapperClassTwo()">

      <div class="sb-top-headerImg" src="assets/images/spotbie-miami.jpg"></div>
      
      <h5 class="text-uppercase">CONNECTING USERS, PLACES TO EAT, SHOPPING, AND EVENTS.</h5>
      
      <button class="sb-button sb-getStarted" (click)="spawnCategories('food')">
        <span>GET STARTED</span>
      </button>

      <img class="sb-logo-withStreet mt-4 mb-4" src="assets/images/spotbie-miami-find-places-to-eat.png" />
      
      <h4 class="text-uppercase">SPOTBIE COMMUNITY</h4>
      
      <p>
        Welcome to the SpotBie community. Find places to eat, events, and shopping around you. By signing up,
        users are able to gain loyalty points from our spotbie community members. These rewards include discounts, free drinks/food, exclusive event merchandise, and more.
        Join now and be part of something fun and worthwile.
      </p>
      
      <div class="sb-homePageIconsTable mt-4 mb-4">
        <div>
          <img src="assets/images/home_imgs/find-places-to-eat.svg" />
          PLACES TO EAT
        </div>
        <div>
          <img src="assets/images/home_imgs/find-events.svg" />
          EVENTS
        </div>        
        <div>
          <img src="assets/images/home_imgs/find-places-for-shopping.svg" />
          SHOPPING
        </div>                        
        <!--<div>
          <img src="assets/images/home_imgs/find-users.svg" />
          USERS
        </div>-->
      </div>

      <img class="mb-4 sb-readImage spotbieAddPointerCursor" style="margin-top: 0%;"
            src="assets/images/home_imgs/jpg/spotbie-miami-places-to-eat.jpg" 
            alt="Picture of girl in her twenties enjoying food in a restaurant." />
            
      <img class='sb-greenIcon' src='assets/images/home_imgs/spotbie-green-icon.svg' />            

      <h4 class="text-uppercase" (click)="togglePlacesToEatInfo()">
        PLACES TO EAT
      </h4>

      <p class="mt-2 mb-2">

        <!--<img class='sb-whiteIconBg' src='assets/images/home_imgs/spotbie-white-icon.svg' />-->

        Are you looking for <b>places to eat</b>? 
        Let SpotBie help you find the best <b>places to eat around you</b>. 
        SpotBie uses GPS technology to help you find <b>places to eat near you</b>. 
        We show you <b>restaurants around you</b> from YELP and display them neatly in a map 
        sorted by the best reviews, prices, distances from you, delivery, reservations, or eat in. 
        With SpotBie, you get to look for <b>restaurants around you</b> by choosing the category you are 
        feeling hungry for that day.

      </p>      

      <button class="sb-button sb-getStarted mt-4 mb-5" (click)="spawnCategories('food')">
        <span>GET STARTED</span>
      </button>

      <img class="mb-4 sb-readImage spotbieAddPointerCursor" style="margin-top: 0%;"
            src="assets/images/home_imgs/jpg/spotbie-miami-events.jpg" 
            alt="Image of event marquee above entrance of theatre."/>  
      
      <img class='sb-greenIcon' src='assets/images/home_imgs/spotbie-green-icon.svg' />

      <h4 class="text-uppercase" (click)="toggleEventsInfo()">
        EVENTS NEAR YOU
      </h4>

      <p class="mt-2 mb-2">

        <!--<img class='sb-whiteIconBg' src='assets/images/home_imgs/spotbie-white-icon.svg' />-->

        Are you looking for <b>events around you</b>? 
        Let SpotBie help you find the best events around you. 
        SpotBie uses GPS technology to help you find events near you. 
        We show you <b>events around you</b> from TicketMaster and display them neatly in a map sorted by prices and distances from you. 
        With SpotBie, you get to look for <b>events around you</b> by choosing the category you feel like vibing to today, tonight, or this week. 
        SpotBie also makes it easier to share events near you with other people through social media or using your devices native sharing functions (text messages, etc.)
        
      </p>      

      <button class="sb-button sb-getStarted mt-4 mb-5" (click)="spawnCategories('events')">
        <span>GET STARTED</span>
      </button>
      
      <img class="mb-4 sb-readImage spotbieAddPointerCursor" 
            style="margin-top: 0%;"
            src="assets/images/home_imgs/jpg/spotbie-miami-shopping.jpg" 
            alt="Picture of two women shopping in a mall."/>

      <img class='sb-greenIcon' src='assets/images/home_imgs/spotbie-green-icon.svg' />

      <h4 class="text-uppercase" (click)="toggleReailShopsInfo()">
        SHOPPING
      </h4>

      <p class="mt-2 mb-2">

        <!--<img class='sb-whiteIconBg' src='assets/images/home_imgs/spotbie-white-icon.svg' />-->

        Let SpotBie help you find the best places to shop with our <b>shopping around you feature</b>. 
        SpotBie's <b>shopping around you feature</b> uses GPS technology to help you find the best places to shop near you. 
        SpotBie shows shops around you from YELP and display them neatly in a map sorted by the best reviews, ratings, prices, and distances from you. 
        With SpotBie, you get to look for shops around you by choosing the category you are looking for. 
        The <b>shopping around you feature</b> also makes it easier to share places to eat with other people through social media or using your devices native sharing functions (text messages, etc.)

      </p>      

      <button class="sb-button sb-getStarted mt-4 mb-5" (click)="spawnCategories('shopping')">
        <span>GET STARTED</span>
      </button>  

      <img class="mb-4 sb-readImage spotbieAddPointerCursor"
            style="margin-top: 0%;"
            src="assets/images/home_imgs/jpg/spotbie-miami-find-new-friends.jpg" 
            alt="Picture of group of friends in a circle playing cards at the beach." />

      <!--<img class='sb-greenIcon' src='assets/images/home_imgs/spotbie-green-icon.svg' />
            
      <h4 class="text-uppercase" (click)="toggleUsersAroundYouInfo()">
        USERS AROUND YOU
      </h4>  

      <p class="mt-2 mb-2">

        <!--<img class='sb-whiteIconBg' src='assets/images/home_imgs/spotbie-white-icon.svg' />-

        SpotBie allows you to easily find other members around you. Wherever you are, you will be able to add your friends and see who else is enjoying the places to eat, the events, and the retails shops
        you enjoy. We all have something in common and SpotBie helps users find those similarities.
        
      </p>      

      <button class="sb-button sb-getStarted mt-4 mb-5" (click)="mobileStartLocation()">
        <span>GET STARTED</span>
      </button>-->

      </div>

    </div>

    <div class="sb-footer pt-5 pb-5">
      <p [routerLink]="['/terms']">Terms & Privacy Policy</p>
      <img class="mt-3 mb-3" src="assets/images/home_imgs/logo_spotbie-02.svg" />
      <p [routerLink]="['/terms']">SpotBie, LLC.&copy; Copyright 2021</p>
    </div>

  </div>

  <div class="map-prompt-mobile pe-none" *ngIf="showMobilePrompt2">

    <div class="spotbie-text-gradient text-uppercase title" id="doubleTapThis">
    </div>

  </div>

  <agm-map  [ngClass]="getMapClass()"
            [streetViewControl]="false"
            #spotbie_map
            [latitude]="lat" 
            [longitude]="lng"
            [styles]="map_styles"
            [zoom]="25"
            [fitBounds]="true">

    <agm-overlay [latitude]="lat" [longitude]="lng" *ngIf="locationFound">

      <div class='spotbie-marker-bg'
          *ngIf="iconUrl"
          [ngStyle]="{'background' : 'url(' + iconUrl + ')',                      
                      'border' : '2px solid ' + bg_color }">
      </div>
          
    </agm-overlay>

    <agm-marker [latitude]="lat" 
                [longitude]="lng"
                *ngIf="locationFound"
                [opacity]="0"
                (markerClick)="selfMarker()"
                [agmFitBounds]="true">

        <agm-info-window #spotbie_user_marker_info_window [isOpen]="true">
          
          <div class='agm_infowindow_color spotbie-text-gradient'>{{ spotbie_username }}</div>
          
        </agm-info-window>

    </agm-marker>

    <div *ngIf="displaySurroundingObjectList">

      <agm-overlay *ngFor="let mapObject of surroundingObjectList"                  
                    [latitude]="mapObject.loc_x"
                    [longitude]="mapObject.loc_y">

        <div class='spotbie-marker-bg' 
              (click)="pullMarker(mapObject)"
              title="{{ mapObject.username }}"
              [ngStyle]="{'background' : 'url(' + mapObject.map_icon + ')',
                          'border' : '2px solid ' + mapObject.bg_color }">
        </div>

      </agm-overlay>  
        
    </div>

    <div *ngIf="show_search_box && searchResults.length > 0">

      <agm-overlay *ngFor="let mapObject of searchResults"
                    [latitude]="mapObject.coordinates.latitude" 
                    [longitude]="mapObject.coordinates.longitude">

        <div class='spotbie-marker-bg'
              (click)="pullSearchMarker(mapObject)"
              [ngStyle]="{'background' : 'url(' + mapObject.icon + ')',
                          'border' : '2px solid #5c7b36' }">
        </div>

      </agm-overlay>                    
      
      <agm-marker *ngFor="let mapObject of searchResults"
                  [latitude]="mapObject.coordinates.latitude" 
                  [longitude]="mapObject.coordinates.longitude"
                  [agmFitBounds]="true"
                  [visible]="false"></agm-marker>
      
    </div>

  </agm-map>

</div>

<app-info-object [info_object]="infoObject" (closeWindow)="infoObjectWindow.open = false" *ngIf="infoObjectWindow.open"></app-info-object>

<!--<div class="spotbie-map-search-wrapper">

  <table class='spotbie-map-search-by' id="spotbie-search-by" *ngIf="locationFound">

    <tr>

      <td (click)="spotMe()" title="Find Me">
        <div id='spotbie_me_search'></div>
      </td>

      <td (click)="spawnCategories('food')" title="Find Food">
        <i class="fa fa-cutlery" aria-hidden="true"></i>
      </td>   

      <td (click)="spawnCategories('shopping')" title="Find Shopping Places">
        <i class="fa fa-shopping-cart" aria-hidden="true"></i>
      </td> 

      <td (click)="spawnCategories('events')" title="Find Events">
        <div id='spotbie_events_search'></div>
      </td> 

      <!--<td (click)="mediaSearch(0)" title="Find Media" *ngIf="isLoggedIn == '1'">
        <div id='spotbie_media_search'></div>
      </td>-->

      <!--<td (click)="placeSearch()" title="My Places">
        <div id='spotbie_place_search'></div>
      </td>-/->

      <td (click)="myFavorites()" title="My Favorites">
        <i class="fa fa-star" aria-hidden="true"></i>
      </td>

    </tr>
  </table>
  
</div>-->


<div class='spotbie-category-search-yelp animated slideInUp' *ngIf="catsUp">

  <input type='text' 
          class='spotbie-searchbar sb-input' 
          placeholder="{{ searchCategoriesPlaceHolder }}" 
          (keyup)="searchSpotBie($event)" />

  <div class='spotbie-close-categories' 
        (click)="closeCategories()" 
        *ngIf="catsUp">
    close
  </div>

</div>

<div class='spotbie-categories animated slideInRight' *ngIf="catsUp && searchCategory != 'events'">

  <div *ngFor="let category of categories; let i = index" [ngClass]="getSingleCatClass(i)" (click)="apiSearch(category)">
    {{ category }}
  </div>

</div>

<div class='spotbie-categories animated slideInRight' *ngIf="catsUp && searchCategory == 'events'">

  <div [ngClass]="getSingleCatClass(i)" *ngFor="let category of categories; let i = index" (click)="showEventSub(category)">
    
    {{ category.name }}

    <!--<div class='spotbie-sub-cat-wrapper' *ngIf="category.show_sub && category.type !== undefined">

      <div class='spotbie-sub-cat' *ngFor="let sub_cat_type of category.type._embedded.subtypes" (click)="apiSearch(sub_cat_type.name)" [SpotBieStopClickPropagation]>
        
        {{ sub_cat_type.name }}

      </div>

    </div>-->

    <div class='spotbie-sub-cat-wrapper' *ngIf="category.show_sub && category.segment !== undefined">

      <div class='spotbie-sub-cat' *ngFor="let sub_cat_type of category.segment._embedded.genres" (click)="apiSearch(sub_cat_type.name, true)" [SpotBieStopClickPropagation]>
        
        {{ sub_cat_type.name }}

        <!--<div *ngIf="sub_cat_type.show_sub_sub">

          <div class='spotbie-subgenre' *ngFor="let subgenre of sub_cat_type._embedded.subgenres" (click)="apiSearch(subgenre.name)" [SpotBieStopClickPropagation]>

            {{ subgenre.name }}
  
          </div>

        </div> -->

      </div>

    </div>    

  </div>

</div>

<div class='spotbie-search-results' *ngIf="show_search_box && searchResults.length > 0">

  <div class='spotbie-close-results-mobile' (click)="closeSearchResults()">close</div>

  <div class='spotbie-close-results' (click)="closeSearchResults()">close</div>

  <!--<table class='spotbie-pull-from'>
    <tr>
      <td (click)="pullFrom('yelp')" class='spotbie-api-pull' [ngStyle]="getApiPullStyle('yelp')" title="Pull from Yelp">YELP</td>
      <td (click)="pullFrom('google')" class='spotbie-api-pull' [ngStyle]="getApiPullStyle('google')" title="Pull from Google">Google</td>
    </tr>
  </table>-->

  <div class='spotbie-search-results-title text-uppercase' *ngIf="type_of_info_object == 'yelp_business'">
    Max Distance  <mat-slider min="1" max="25" step="1" value="{{ maxDistance }}"
                            (change)="updateDistance($event)"></mat-slider>
    {{ maxDistance }} miles.                            
  </div>

  <div class='spotbie-search-results-title text-uppercase' *ngIf="type_of_info_object == 'ticketmaster_events'">
    Max Distance  <mat-slider min="1" max="50" step="1" value="{{ maxDistance }}"
                            (change)="updateDistance($event)"></mat-slider>
    {{ maxDistance }} miles.                            
  </div>

  <div class='spotbie-search-results-title'>

    <table class='spotbie-controls-search-results' *ngIf="searchCategorySorter == 'food'">
      <tr>
        <td (click)="sortBy(0)" title="Sort By Distance"><img src='assets/images/road.png' /></td>
        <td (click)="sortBy(1)" title="Sort By Rating"><img src='assets/images/star.png' /></td>
        <td (click)="sortBy(2)" title="Sort By Reviews"><img src='assets/images/review.png' /></td>
        <td (click)="sortBy(3)" title="Sory By Pricing"><img src='assets/images/money.png' /></td>
        <td (click)="sortBy(4)" title="Offers Delivery"><img src='assets/images/bag.png' /></td>
        <td (click)="sortBy(5)" title="Offers Pick-Up"><img src='assets/images/arm.png' /></td>
        <td (click)="sortBy(6)" title="Offers Reservations"><img src='assets/images/hotel.png' /></td>
      </tr>    
    </table>

    <table class='spotbie-controls-search-results' (click)="showOpen()" title="Opened or Closed" [ngStyle]="{ 'border-right' : 'unset' }" *ngIf="searchCategorySorter == 'food'">
      <td><span class='fa fa-circle spotbie-is-open'></span></td>
      <td *ngIf="showOpened == false"><span class='fa fa-circle spotbie-is-closed'></span></td>
      <td *ngIf="showOpened == true">OPEN</td>
      <td *ngIf="showOpened == false">OPEN/CLOSED</td>
    </table>
  
    <table class='spotbie-controls-search-results' *ngIf="searchCategorySorter == 'shopping'">
      <tr>
        <td (click)="sortBy(0)" title="Sort By Distance"><img src='assets/images/road.png' /></td>
        <td (click)="sortBy(1)" title="Sort By Rating"><img src='assets/images/star.png' /></td>
        <td (click)="sortBy(2)" title="Sort By Reviews"><img src='assets/images/review.png' /></td>
        <td (click)="sortBy(3)" [ngStyle]="{ 'border-right' : 'unset' }"  title="Sory By Pricing"><img src='assets/images/money.png' /></td>     
      </tr>    
    </table>

    <table (click)="showOpen()" title="Opened or Closed" [ngStyle]="{ 'border-right' : 'unset' }" *ngIf="searchCategorySorter == 'shopping'">
      <td><span class='fa fa-circle spotbie-is-open'></span></td>
      <td *ngIf="showOpened == false"><span class='fa fa-circle spotbie-is-closed'></span></td>
      <td *ngIf="showOpened == true">OPEN</td>
      <td *ngIf="showOpened == false">OPEN/CLOSED</td>
    </table>   
    
    <table class='spotbie-controls-search-results' *ngIf="searchCategorySorter == 'events'">
      <tr>
        <td (click)="hideSearchResults()" title="Hide Results"><img src='assets/images/eye.png' /></td>
        <td (click)="sortBy(0)" title="Sort By Distance"><img src='assets/images/road.png' /></td>
        <td (click)="sortBy(3)" title="Sort By Pricing"><img src='assets/images/money.png' /></td>
        <td (click)="sortBy(7)" title="Events Today">Today</td>
        <td (click)="sortBy(8)" title="Events This Weekend" [ngStyle]="{ 'border-right' : 'unset' }">This Weekend</td>
      </tr>    
    </table>

  </div>

  <div class='spotbie-search-results-title spotbie-sorting text-uppercase'>

    Sorted by {{ sort_by_txt }} 
    <span *ngIf="sortAc != 4 && sortAc != 5 && sortAc != 6 && sortAc != 7 && sortAc != 8">({{ sorting_order }})</span>
    <span (click)="showOpen()" *ngIf="searchCategorySorter != 'events'"> - {{ showingOpenedStatus }}</span>

    <ng-template *ngIf="searchCategorySorter != 'events'">
      <span class='fa fa-circle spotbie-is-open' [ngStyle]="{ 'margin-left' : '5px' }"></span>
      <span class='fa fa-circle spotbie-is-closed' *ngIf="showOpened == false" [ngStyle]="{ 'margin-left' : '5px' }"></span>
    </ng-template>

  </div>
  

  <div class='spotbie-search-result-wrapper' *ngIf="showSearchResults">

    <div class='spotbie-search-results-title text-uppercase'>

      <span *ngIf="searchCategory !== 'events'">Showing {{ loadedTotalResults }} results within {{ maxDistance }} miles. </span>
  
      <span class='sb-button sb-page-button text-uppercase' (click)="loadMoreResults(0)" *ngIf="allPages > 1">
        Previous
      </span>   

      <span class='sb-button sb-page-button text-uppercase' (click)="loadMoreResults(1)" *ngIf="allPages > 1">
        Next
      </span>
  
      <span class='spotbie-search-page-number'>{{ around_me_search_page }} / {{ allPages }}</span>
  
    </div>
    
    <div class='spotbie-no-results' *ngIf='searchResults.length == 0'>No Results Available.</div>

    <div class='spotbie-search-result' *ngFor='let search_result of searchResults' (click)="pullSearchMarker(search_result)">
      
      <table class='spotbie-search-result-table'>
        <tr>
          
          <td *ngIf="search_result.image_url != '0'">
            <div class='spotbie-search-result-image'[ngStyle]="{ 'background' : 'url(' + search_result.image_url + ')' }" ></div>          
          </td>
          
          <td *ngIf="type_of_info_object == 'yelp_business'">

            <div class='spotbie-search-result-title' >
        
              {{ search_result.name }} 
              
              <span class='spotbie-search-result-price' *ngIf="search_result.price_on == '1'">({{ search_result.price }})</span>
      
            </div>

            <table class='spotbie-yelp-rating-table'>
              <tr>
                <td>
                  <div class='spotbie-search-result-rating-img' [ngStyle]="{ 'background' : 'url(' + search_result.rating_image + ')' }"></div>
                </td>
                <td>
                  <div class='spotbie-search-result-yelp-logo' [ngStyle]="{ 'background' : 'url(assets/images/yelp/yelp_logo.png)' }"></div>
                </td>
              </tr>
            </table>
  
            <div class='spotbie-review-count'>
              Based on {{ search_result.review_count }} Reviews
            </div>

            <div class='spotbie-distance'>
              {{ search_result.distance }} miles from you.
            </div>                        

            <div class='spotbie-search-result-phone' *ngIf="search_result.phone != ''">
              {{ search_result.display_phone }}
            </div>       

          </td>

          <td *ngIf="type_of_info_object == 'ticketmaster_events'">

            <div class='spotbie-venue-name' *ngIf="search_result._embedded.venues[0]">
              {{ search_result._embedded.venues[0].name }}
            </div>

            <div class='spotbie-distance'>
              {{ search_result.distance }} miles from you.
            </div>
                        
            <div class='spotbie-time-event' *ngIf="search_result.dates.start.localDate">
              {{ search_result.dates.start.spotbieDate }}
            </div>

            <div class='spotbie-time-event' *ngIf="search_result.dates.start.spotbieHour">
              {{ search_result.dates.start.spotbieHour }}
            </div>

            <div class='spotbie-price-ranges' *ngIf="search_result.priceRanges !== undefined">
              Price Ranges ${{ search_result.priceRanges[0].min }} to ${{ search_result.priceRanges[0].max }}
            </div>

            <div class='spotbie-event-code' *ngIf="search_result.dates.status.code">
              Status: {{ search_result.dates.status.code }}
            </div>      

          </td>

        </tr>

      </table>
  
      <div class='spotbie-search-result-transactions' *ngIf="search_result.transactions_on == '1'">{{ search_result.friendly_transactions }}</div>

    </div>

    <div>

      <span class='sb-button sb-page-button text-uppercase' (click)="loadMoreResults(0)" *ngIf="allPages > 1">
        Previous
      </span>   
  
      <span class='sb-button sb-page-button text-uppercase' (click)="loadMoreResults(1)" *ngIf="allPages > 1">
        Next
      </span>
  
      <div class='spotbie-search-results-title text-uppercase' style="text-align: center;">
          {{ around_me_search_page }} / {{ allPages }}
      </div>

    </div>

  </div>

</div>

<div class='spotbie-search-results no-results' *ngIf="showNoResultsBox">
  
  <div class='spotbie-no-results' style="text-align: center;" *ngIf="sortEventDate == 'none'">No results available for "{{ search_keyword }}" within {{ maxDistance }} miles.</div>
  <div class='spotbie-no-results' style="text-align: center;" *ngIf="sortEventDate == 'today'">No results today available for "{{ search_keyword }}" within {{ maxDistance }} miles.</div>
  <div class='spotbie-no-results' style="text-align: center;" *ngIf="sortEventDate == 'weekend'">No results this weekend available for "{{ search_keyword }}" within {{ maxDistance }} miles.</div>

  <div class='spotbie-search-results-title text-uppercase'>
    Max Distance  <mat-slider min="0" max="{{ maxDistanceCap }}" step="1" value="{{ maxDistance }}"
                            (change)="updateDistance($event)"></mat-slider>
    {{ maxDistance }} miles.                            
  </div>

</div>

<app-user-info-object [currentMarker]="currentMarker" *ngIf="sliderRight" (close)="sliderRight = false"></app-user-info-object>

<div class="spotbie-overlay-window" *ngIf="coming_soon_ov" [ngStyle]="{'background-color' : bg_color}">

  <div class='spotbie-coming-soon'>
    {{coming_soon_ov_title}}
  </div>

  <div class='spotbie-coming-soon-desc'>
    {{coming_soon_ov_text}}
  </div>    

  <div class="sb-closeButton" (click)="closeCmS()"><i class="fa fa-times"></i></div>

</div>

<app-welcome *ngIf="locationPrompt && !isDesktop" (locationPrompted)="acceptLocationPrompt()"></app-welcome>

<app-my-favorites *ngIf='myFavoritesWindow.open' (closeWindow)="myFavoritesWindow.open = false"></app-my-favorites>

<app-location-saver *ngIf='myPlacesWindow.open' (closeWindow)="myPlacesWindow.open = false"></app-location-saver>

<app-toast-helper [helper_config]="toastHelperConfig" 
                  *ngIf="toastHelper"
                  (dismiss_toast)="dismissToast($event)"></app-toast-helper>